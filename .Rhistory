suppressPackageStartupMessages({
library(rstudioapi, quietly=T)
library(dplyr, quietly = T)
library(ggplot2, quietly = T)
library(WGCNA, quietly = T)
})
options(stringsAsFactors = F)
enableWGCNAThreads()
#Paths to files
workingD <- rstudioapi::getActiveDocumentContext()$path
setwd(dirname(workingD))
#Paths to files
workingD <- rstudioapi::getActiveDocumentContext()$path
setwd(dirname(workingD))
load(paste0(filesD,'temp.RData'))
filesD <- 'resultsWGCNA/'
load(paste0(filesD,'temp.RData'))
inputData <- paste0(filesD,'initialData_datExpr_sampleTable.RData')
inputNet <- paste0(filesD, 'network_manual_construction.RData')
load(inputData)
load(inputNet)
plotTOMF <- paste0(filesD, 'TOM heatmap.pdf')
sft_power <- 12
enhance_power <- 5
pdf(file = plotTOMF, height = 20, width = 10)
TOMplot(plotTOM, geneTree, moduleColors, main = "Network heatmap plot, all genes")
invisible(dev.off())
dev.off()
dev.off()
while (!is.null(dev.list()))  dev.off()
tiff(file = plotTOMF)
TOMplot(plotTOM, geneTree, moduleColors, main = "Network heatmap plot, all genes")
