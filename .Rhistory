library(pheatmap, quietly = TRUE)
library(grid, quietly = TRUE)
library(BiocManager, quietly = TRUE)
library(DESeq2, quietly = TRUE)
library(AnnotationDbi, quietly = TRUE)
})
## 1. Parse arguments
#####################
option_list = list(
make_option(c("-c", "--configfile"), type="character", default=NULL,
help="configuration file must have the next structure: 'sample' 'file' 'condition' (tab-separated and with that header)", metavar="character"),
make_option(c("-p", "--cutoff"), type="numeric", default=0.05,
help="cut-off value to assign DEGs", metavar="numeric"),
make_option(c("-d", "--database"), type="character", default=NULL,
help="the name of the annotation database in the format org.XX.eg.db (to add gene names)", metavar="character")
)
opt_parser = OptionParser(option_list=option_list)
opt = parse_args(opt_parser)
if (is.null(opt$configfile)){
print_help(opt_parser)
stop("AT LEAST ONE ARGUMENT MUST BE PROVIDED", call.=FALSE)
}
## 2. Parameters
################
# load configuration file
config <- opt$configfile
sampleTable <- read.table(config, header=TRUE)
cutoff <- opt$cutoff
orgdb <- opt$database
if (!is.null(orgdb)){
if (orgdb %in% row.names(installed.packages()) == FALSE) BiocManager::install(orgdb)
suppressPackageStartupMessages({
library(orgdb, quietly = TRUE, character.only = TRUE)
})
}
## 3. Read data
###############
data <- DESeqDataSetFromHTSeqCount(sampleTable, directory=".", design= ~condition)
# extract unique elements of condition
levels <- unique(sampleTable$condition)
ll <- length(levels)
## 4. Differential test
#######################
# Analysis
#---------
dds <- DESeq(data)
ncounts <- counts(dds, normalized=TRUE)
write.table (ncounts, file="deseq2_counts.tsv", quote=FALSE, sep = "\t", col.names=NA)
select <- order(rowMeans(counts(dds,normalized=TRUE)),decreasing=TRUE)[1:30]
hmcol <- colorRampPalette(c("yellow", "black", "cyan"))(299)
# Data transformations to better visualize them
#----------------------------------------------
# Tikhonov Regularized Log Transformation (RLT)
# see http://en.wikipedia.org/wiki/Tikhonov_regularization
rlt <- rlog(dds)
rltMat <- assay(rlt)
# variance stabilizing transformation (VST)
# see http://en.wikipedia.org/wiki/Variance-stabilizing_transformation
vst <- varianceStabilizingTransformation(dds)
vstMat <- assay(vst)
# effects of the transformation in the variance
notAllZero <- (rowSums(counts(dds))>0)	# dicard zero counts
# distances heatmap
distRL <- dist(t(rltMat))
distMat <- as.matrix(distRL)
hc <- hclust(distRL)
tiff(filename = "deseq2_distances.tiff", units="in", width=5, height=5, res=300)
heatmap.2(distMat, Rowv=as.dendrogram(hc), symm=TRUE, trace="none", col=rev(hmcol),
margin=c(10, 6), main="Distances matrix", key.title=NA)
invisible(dev.off())
tiff(filename = "deseq2_hm30_vst.tiff", units="in", width=5, height=5, res=300)
par(cex.main=0.8)
heatmap.2(vstMat[select,], col=hmcol, Rowv=FALSE, Colv=FALSE, scale="none",
dendrogram="none", trace="none", margin=c(5, 7), main="30 most highly \n expressed genes (VST)", labRow=F, key.title=NA)
invisible(dev.off())
# PCA plot_labelled
require("ggrepel")
tiff(filename = "deseq2_pca_labels.tiff", units="in", width=5, height=5, res=300)
pca <- plotPCA(rlt)
pca + ggtitle("Principal Components Plot") + geom_text_repel(aes(label=colnames(rlt)),  size=2)
invisible(dev.off())
# Dispersion_plot
# plots the per-gene dispersion estimates together with the fitted
# mean-dispersion relationship
tiff(filename = "deseq2_dispersion.tiff", units="in", width=5, height=5, res=300)
plotDispEsts(dds, main="Per-gene dispersion estimates")
invisible(dev.off())
# Pair-wise comparisons
#----------------------
for (i in 1:(ll-1)) {
for (j in (i+1):ll) {
l1 <- toString(levels[i])
l2 <- toString(levels[j])
conditions = c(l1, l2)
conds = subset(sampleTable, sampleTable$condition %in% conditions)
samples = conds$sample
df = data.frame(condition=conds$condition)
rownames(df) = samples
my_colour = list(df=c(l1="orange", l2="skyblue"))
suffix <- paste(l2, l1, sep="_vs_")
res <- results(dds, contrast=c("condition", l2, l1))
res$FoldChange <- 2^res$log2FoldChange
res <- res[colnames(res)[c(1,7,2:6)]] # order columns
# MAplot
file <- paste("deseq2_maplot_", suffix, ".tiff", sep="")
main <- paste("MA-plot", suffix, sep=" ")
tiff(filename = file, units="in", width=5, height=5, res=300)
plotMA(res, alpha= 0.05, main=main)
#		identify(res$baseMean, res$log2FoldChange)	# draw line number of gene clicking on a point
invisible(dev.off())
if (!is.null(orgdb)){
symbol <- mapIds(get(orgdb), keys=row.names(res), column="ENTREZID", keytype="SYMBOL", multiVals="first") #to obtain gene symbols
description <- mapIds(get(orgdb), keys=row.names(res), column="GENENAME", keytype="SYMBOL", multiVals="first") #to obtain description
res <- cbind(symbol, res) #to add the symbols to the results file
res$description <- description
}
# writing results for all & significative genes
file <- paste("deseq2_all_", suffix, ".tsv", sep="")
write.table (res, file=file, quote=FALSE, sep="\t", col.names=NA)
file <- paste("deseq2_sig_padj", suffix, ".tsv", sep="")
sig <- subset(res, res$padj < cutoff)
subcounts <- subset(ncounts, rownames(ncounts) %in% rownames(sig))
subcounts <- subcounts[,rownames(df)]
lsubcounts <- log2(subcounts+1)
write.table (sig, file=file, quote=FALSE, sep="\t", col.names=NA)
# save results with pvalue instead of padj
file <- paste("deseq2_sig_pval", suffix, ".tsv", sep="")
sig_pval <- subset(res, res$pvalue < cutoff)
write.table (sig_pval, file=file, quote=FALSE, sep="\t", col.names=NA)
# heatmap of DEG
file <- paste("deseq2_heatmap_", suffix, ".tiff", sep="")
main <- paste("Heatmap", suffix, "log2(exp+1)", sep=" ")
tiff(filename = file, units="in", width=5, height=5, res=300)
pheatmap(mat=lsubcounts, color=hmcol, border_color=F, scale="row", cluster_cols=T,
cluster_rows=T, fontsize_row=9, annotation_col=df, annotation_colors=my_colour, show_rownames=F,
show_colnames=T, annotation_names_col=F, annotation_names_row=F, main=main)
invisible(dev.off())
}
}
# 5. Save work space and quit
#############################
msg1 = "!!O_o!!----------------DONE------------------"
msg2 = "That's all folks! Quitting ..."
print(msg1)
print(msg2)
save(list=ls(), file="deseq2.RData")
q()
## R script to run a differential expression analysis using DESeq2.
## Counts files must be generated by HTSeq.
## RamÃ³n PeirÃ³-Pastor, Eva Castillo Rosa, Eva SacristÃ¡n and Sandra GonzÃ¡lez (GENGS CBMSO)
## Based on a draft script by Alberto Rastrojo Lastras (CBMSO)
##################################################################
## O. Clean and libraries
##################
cat("\n Checking if all libraries are installed \n")
rm(list=ls())
repos = "http://cran.us.r-project.org"
if ("optparse" %in% row.names(installed.packages())  == FALSE) install.packages("optparse", repos = repos)
if ("gplots" %in% row.names(installed.packages())  == FALSE) install.packages("gplots", repos = repos)
if ("ggplot2" %in% row.names(installed.packages())  == FALSE) install.packages("ggplot2", repos = repos)
if ("RColorBrewer" %in% row.names(installed.packages())  == FALSE) install.packages("RColorBrewer", repos = repos)
if ("cluster" %in% row.names(installed.packages())  == FALSE) install.packages("cluster", repos = repos)
if ("pheatmap" %in% row.names(installed.packages())  == FALSE) install.packages("pheatmap", repos = repos)
if ("grid" %in% row.names(installed.packages())  == FALSE) install.packages("grid", repos = repos)
if (!requireNamespace("BiocManager", quietly = TRUE)) install.packages("BiocManager", repos = repos)
if ("DESeq2" %in% row.names(installed.packages()) == FALSE) BiocManager::install("DESeq2")
if ("AnnotationDbi" %in% row.names(installed.packages()) == FALSE) BiocManager::install("AnnotationDbi")
if ("vsn" %in% row.names(installed.packages())  == FALSE) BiocManager::install("vsn")
suppressPackageStartupMessages({
library(optparse, quietly = TRUE)
library(vsn, quietly = TRUE)
library(gplots, quietly = TRUE)
library(ggplot2, quietly = TRUE)
library(RColorBrewer, quietly = TRUE)
library(cluster, quietly = TRUE)
library(pheatmap, quietly = TRUE)
library(grid, quietly = TRUE)
library(BiocManager, quietly = TRUE)
library(DESeq2, quietly = TRUE)
library(AnnotationDbi, quietly = TRUE)
})
invisible(readline(prompt="Press [enter] to continue"))
## 1. Parse arguments
#####################
option_list = list(
make_option(c("-c", "--configfile"), type="character", default=NULL,
help="configuration file must have the next structure: 'sample' 'file' 'condition' (tab-separated and with that header)", metavar="character"),
make_option(c("-p", "--cutoff"), type="numeric", default=0.05,
help="cut-off value to assign DEGs", metavar="numeric"),
make_option(c("-d", "--database"), type="character", default=NULL,
help="the name of the annotation database in the format org.XX.eg.db (to add gene names)", metavar="character")
)
opt_parser = OptionParser(option_list=option_list)
opt = parse_args(opt_parser)
if (is.null(opt$configfile)){
print_help(opt_parser)
stop("AT LEAST ONE ARGUMENT MUST BE PROVIDED", call.=FALSE)
}
## 2. Parameters
################
# load configuration file
config <- opt$configfile
sampleTable <- read.table(config, header=TRUE)
cutoff <- opt$cutoff
orgdb <- opt$database
if (!is.null(orgdb)){
if (orgdb %in% row.names(installed.packages()) == FALSE) BiocManager::install(orgdb)
suppressPackageStartupMessages({
library(orgdb, quietly = TRUE, character.only = TRUE)
})
}
## 3. Read data
###############
data <- DESeqDataSetFromHTSeqCount(sampleTable, directory=".", design= ~condition)
# extract unique elements of condition
levels <- unique(sampleTable$condition)
ll <- length(levels)
## 4. Differential test
#######################
# Analysis
#---------
dds <- DESeq(data)
ncounts <- counts(dds, normalized=TRUE)
write.table (ncounts, file="deseq2_counts.tsv", quote=FALSE, sep = "\t", col.names=NA)
select <- order(rowMeans(counts(dds,normalized=TRUE)),decreasing=TRUE)[1:30]
hmcol <- colorRampPalette(c("yellow", "black", "cyan"))(299)
# Data transformations to better visualize them
#----------------------------------------------
# Tikhonov Regularized Log Transformation (RLT)
# see http://en.wikipedia.org/wiki/Tikhonov_regularization
rlt <- rlog(dds)
rltMat <- assay(rlt)
# variance stabilizing transformation (VST)
# see http://en.wikipedia.org/wiki/Variance-stabilizing_transformation
vst <- varianceStabilizingTransformation(dds)
vstMat <- assay(vst)
# effects of the transformation in the variance
notAllZero <- (rowSums(counts(dds))>0)	# dicard zero counts
# distances heatmap
distRL <- dist(t(rltMat))
distMat <- as.matrix(distRL)
hc <- hclust(distRL)
tiff(filename = "deseq2_distances.tiff", units="in", width=5, height=5, res=300)
heatmap.2(distMat, Rowv=as.dendrogram(hc), symm=TRUE, trace="none", col=rev(hmcol),
margin=c(10, 6), main="Distances matrix", key.title=NA)
invisible(dev.off())
tiff(filename = "deseq2_hm30_vst.tiff", units="in", width=5, height=5, res=300)
par(cex.main=0.8)
heatmap.2(vstMat[select,], col=hmcol, Rowv=FALSE, Colv=FALSE, scale="none",
dendrogram="none", trace="none", margin=c(5, 7), main="30 most highly \n expressed genes (VST)", labRow=F, key.title=NA)
invisible(dev.off())
# PCA plot_labelled
require("ggrepel")
tiff(filename = "deseq2_pca_labels.tiff", units="in", width=5, height=5, res=300)
pca <- plotPCA(rlt)
pca + ggtitle("Principal Components Plot") + geom_text_repel(aes(label=colnames(rlt)),  size=2)
invisible(dev.off())
# Dispersion_plot
# plots the per-gene dispersion estimates together with the fitted
# mean-dispersion relationship
tiff(filename = "deseq2_dispersion.tiff", units="in", width=5, height=5, res=300)
plotDispEsts(dds, main="Per-gene dispersion estimates")
invisible(dev.off())
# Pair-wise comparisons
#----------------------
for (i in 1:(ll-1)) {
for (j in (i+1):ll) {
l1 <- toString(levels[i])
l2 <- toString(levels[j])
conditions = c(l1, l2)
conds = subset(sampleTable, sampleTable$condition %in% conditions)
samples = conds$sample
df = data.frame(condition=conds$condition)
rownames(df) = samples
my_colour = list(df=c(l1="orange", l2="skyblue"))
suffix <- paste(l2, l1, sep="_vs_")
res <- results(dds, contrast=c("condition", l2, l1))
res$FoldChange <- 2^res$log2FoldChange
res <- res[colnames(res)[c(1,7,2:6)]] # order columns
# MAplot
file <- paste("deseq2_maplot_", suffix, ".tiff", sep="")
main <- paste("MA-plot", suffix, sep=" ")
tiff(filename = file, units="in", width=5, height=5, res=300)
plotMA(res, alpha= 0.05, main=main)
#		identify(res$baseMean, res$log2FoldChange)	# draw line number of gene clicking on a point
invisible(dev.off())
if (!is.null(orgdb)){
symbol <- mapIds(get(orgdb), keys=row.names(res), column="ENTREZID", keytype="SYMBOL", multiVals="first") #to obtain gene symbols
description <- mapIds(get(orgdb), keys=row.names(res), column="GENENAME", keytype="SYMBOL", multiVals="first") #to obtain description
res <- cbind(symbol, res) #to add the symbols to the results file
res$description <- description
}
# writing results for all & significative genes
file <- paste("deseq2_all_", suffix, ".tsv", sep="")
write.table (res, file=file, quote=FALSE, sep="\t", col.names=NA)
file <- paste("deseq2_sig_padj", suffix, ".tsv", sep="")
sig <- subset(res, res$padj < cutoff)
subcounts <- subset(ncounts, rownames(ncounts) %in% rownames(sig))
subcounts <- subcounts[,rownames(df)]
lsubcounts <- log2(subcounts+1)
write.table (sig, file=file, quote=FALSE, sep="\t", col.names=NA)
# save results with pvalue instead of padj
file <- paste("deseq2_sig_pval", suffix, ".tsv", sep="")
sig_pval <- subset(res, res$pvalue < cutoff)
write.table (sig_pval, file=file, quote=FALSE, sep="\t", col.names=NA)
# heatmap of DEG
file <- paste("deseq2_heatmap_", suffix, ".tiff", sep="")
main <- paste("Heatmap", suffix, "log2(exp+1)", sep=" ")
tiff(filename = file, units="in", width=5, height=5, res=300)
pheatmap(mat=lsubcounts, color=hmcol, border_color=F, scale="row", cluster_cols=T,
cluster_rows=T, fontsize_row=9, annotation_col=df, annotation_colors=my_colour, show_rownames=F,
show_colnames=T, annotation_names_col=F, annotation_names_row=F, main=main)
invisible(dev.off())
}
}
# 5. Save work space and quit
#############################
msg1 = "!!O_o!!----------------DONE------------------"
msg2 = "That's all folks! Quitting ..."
print(msg1)
print(msg2)
save(list=ls(), file="deseq2.RData")
#q()
suppressPackageStartupMessages({
library(optparse, quietly = TRUE)
library(vsn, quietly = TRUE)
library(gplots, quietly = TRUE)
library(ggplot2, quietly = TRUE)
library(RColorBrewer, quietly = TRUE)
library(cluster, quietly = TRUE)
library(pheatmap, quietly = TRUE)
library(grid, quietly = TRUE)
library(BiocManager, quietly = TRUE)
library(DESeq2, quietly = TRUE)
library(AnnotationDbi, quietly = TRUE)
library('org.Hs.eg.db', quietly = TRUE, character.only = TRUE)
library(EnhancedVolcano, quietly = TRUE)
library(tidyr, quietly= TRUE)
})
#Load variables of each sample
config <- './configfile_pedlabels.txt'
sampleTable <- read.table(config, header=TRUE, colClasses= c('factor','character',
'factor',
'factor', 'factor',
'factor'))
#Convert the counts into a DeSeq DataSet object
data <- DESeqDataSetFromHTSeqCount(sampleTable, directory=".",
design = ~ age + gender + PED + condition)
## Analysis
#Pre-filtering: clean some of the noise in the counts
keep <- rowSums(counts(data)) >= 10
data <- data[keep,]
rm(keep)
# DESeq: not original function to adjust number of iterations
dds <- estimateSizeFactors(data)
dds <- estimateDispersions(dds)
dds <- nbinomWaldTest(dds, maxit = 10000)
dds_raw <- counts(dds, normalized=FALSE)
dds_normalized <- counts(dds, normalized=TRUE)
#Convert the counts into a DeSeq DataSet object
data <- DESeqDataSetFromHTSeqCount(sampleTable, directory=".",
design = ~ age + gender + PED + condition)
sampleTable <- read.table(config, header=TRUE, colClasses= c('factor','character',
'factor',
'factor', 'factor',
'factor'))
#Load variables of each sample
config <- './configfile_pedlabels.txt'
sampleTable <- read.table(config, header=TRUE, colClasses= c('factor','character',
'factor',
'factor', 'factor',
'factor'))
#####################
setwd("C:/Users/CBM/Desktop/RNAseq_bipolarDisorder")
suppressPackageStartupMessages({
library(BiocManager, quietly = TRUE)
library(clusterProfiler, quietly = TRUE)
library(enrichplot, quietly = TRUE)
library(UpSetR, quietly = TRUE)
library(ggplot2, quietly = TRUE)
library(RColorBrewer, quietly = TRUE)
library(org.Hs.eg.db)
library(fgsea, quietly = T)
})
suppressPackageStartupMessages({
library(BiocManager, quietly = TRUE)
library(clusterProfiler, quietly = TRUE)
library(enrichplot, quietly = TRUE)
library(UpSetR, quietly = TRUE)
library(ggplot2, quietly = TRUE)
library(RColorBrewer, quietly = TRUE)
library(org.Hs.eg.db)
library(fgsea, quietly = T)
library(msigdbr, quietly = T)
})
install.packages('msigdbr')
data <- read.delim('MyResults_DEG/sig_pval.tsv', sep= "\t", header=T, row.names = 1)
data <- read.delim('MyResults_DEG/all_genes.tsv', sep= "\t", header=T, row.names = 1)
dat <- data$stat
rownames(data)
names(dat) <- as.character(rownames(data))
duplicated(names(dat))
sum(duplicated(names(dat)))
dat <- sort(dat, decreasing=TRUE)
?msigdbr
head(dat)
#Calculate GSEA and write tables of results
category <- 'H' # probar con C5
db_sets <- msigdbr(species = 'Homo sapiens', category = category)#%>%
suppressPackageStartupMessages({
library(BiocManager, quietly = TRUE)
library(clusterProfiler, quietly = TRUE)
library(enrichplot, quietly = TRUE)
library(UpSetR, quietly = TRUE)
library(ggplot2, quietly = TRUE)
library(RColorBrewer, quietly = TRUE)
library(org.Hs.eg.db)
library(fgsea, quietly = T)
library(msigdbr, quietly = T)
})
db_sets <- msigdbr(species = 'Homo sapiens', category = category)#%>%
View(data)
View(db_sets)
db_sets <- msigdbr(species = 'Homo sapiens', category = category)%>%
dplyr::select(gs_name, ensembl_gene)
egs <- GSEA(geneList = dat, pvalueCutoff = 0.05, eps = 0, pAdjustMethod = "BH",
seed = T, TERM2GENE = db_sets)
head(egs@result)
egs_df <- data.frame(egs@result)
egs_df
egs_df
type(egs)
class(egs)
head(egs$result)
egs_df <- data.frame(egs@result)
head(egs_df)
View(egs_df)
dim(egs_df)
egs_df <- select(egs_df, -ID, -Description)
egs_df <- egs_df[, -c(1,2)]
egs_df
write.table(egs_df, file = 'MyResults/GSEA_results.txt', sep= "\t", quote = F, row.names = T)
write.table(egs_df, file = 'MyResults_GSEA/GSEA_results.txt', sep= "\t", quote = F, row.names = T)
category <- 'C5' # probar con C5
db_sets <- msigdbr(species = 'Homo sapiens', category = category)%>%
dplyr::select(gs_name, ensembl_gene)
head(db_sets) #each gene associated with each msig group
set.seed(1)
egs <- GSEA(geneList = dat, pvalueCutoff = 0.05, eps = 0, pAdjustMethod = "BH",
seed = T, TERM2GENE = db_sets)
head(egs@result)
egs_df <- data.frame(egs@result)
egs_df <- egs_df[, -c(1,2)]
category <- 'H'
db_sets <- msigdbr(species = 'Homo sapiens', category = category)%>%
dplyr::select(gs_name, ensembl_gene)
head(db_sets) #each gene associated with each msig group
set.seed(1)
egs <- GSEA(geneList = dat, pvalueCutoff = 0.05, eps = 0, pAdjustMethod = "BH",
seed = T, TERM2GENE = db_sets)
head(egs@result)
egs_df <- data.frame(egs@result)
egs_df <- egs_df[, -c(1,2)]
write.table(egs_df, file = 'MyResults_GSEA/GSEA_results.txt', sep= "\t", quote = F, row.names = T)
jpeg(file = "MyResults_GSEA/Dotplot.jpeg", units = 'in', width = 15, height = 10,
res = 300)
par(mar = c(2, 2, 2, 5))
dotplot(egs, x = "GeneRatio", color = "pvalue", showCategory = 20,
font.size = 15)
invisible(dev.off())
jpeg(file = "MyResults_GSEA/Gene_concept_net.jpeg", units = 'in',
width = 15, height = 10, res = 300)
par(mar = c(2, 2, 2, 5))
cnetplot(egs_genename, categorySize="pvalue", foldChange=NULL,
font.size = 15, colorEdge = T)
?cnetplot
cnetplot(egs, categorySize="pvalue", foldChange=NULL,
font.size = 15, colorEdge = T)
?dotplot
jpeg(file = "MyResults_GSEA/Gene_concept_net.jpeg", units = 'in',
width = 15, height = 10, res = 300)
par(mar = c(2, 2, 2, 5))
cnetplot(egs, categorySize="pvalue", font.size = 15, colorEdge = T)
invisible(dev.off())
jpeg(file = "MyResults_GSEA/Gene_concept_net.jpeg", units = 'in',
width = 15, height = 10, res = 300)
par(mar = c(2, 2, 2, 5))
cnetplot(egs, categorySize="p.adjust", font.size = 15, colorEdge = T)
invisible(dev.off())
jpeg(file = "MyResults_GSEA/Dotplot.jpeg", units = 'in', width = 15, height = 10,
res = 300)
par(mar = c(2, 2, 2, 5))
dotplot(egs, x = "GeneRatio", color = "p.adjust", showCategory = 20,
font.size = 15)
invisible(dev.off())
jpeg(file = "MyResults_GSEA/GSEA_ridge.jpeg", units = 'in', width = 15, height = 10, res = 300)
par(mar = c(2, 2, 2, 5))
ridgeplot(egs, fill="p.adjust", orderBy= 'NES', core_enrichment = T)
invisible(dev.off())
?ridgeplot
##Heatplot
jpeg(file = "MyResults_GSEA/GSEA_heatplot.jpeg", units = 'in', width = 20, height = 10, res = 300)
heatplot(egs, foldChange=NULL)
invisible(dev.off())
for (j in 1:5){
pl <- gseaplot2(egs, geneSetID=j, title = egs$Description[j], base_size=40, color="red")
desc <- gsub(" ", "_", egs$Description[j], fixed = TRUE)
filename <- paste('MyResults_GSEA/',desc, "_GSEA.jpeg", sep ="")
ggsave(pl, file=filename, device = "jpeg", units= "in", height = 15, width = 20)
}
gseap <- gseaplot2(egs, geneSetID = 'todos', pvalue_table = T)
ggsave(gseap, file='All gseaplots', device = "jpeg", units= "in", height = 15, width = 20)
